# Nginx 介绍

## Nginx 系统架构
Nginx 包含一个单一的 master 进程和多个 worker 进程(通常设置为服务器上的 CPU 核心数)，所有这些进程都是单线程的，并且设计为同时处理成千上万个连接，worker 进程是处理连接的地方，因为这个组建局势用与处理客户端请求的，Nginx 使用了操作系统事件机制来快速响应这些请求。

Nginx 的 master 进程负责读取配置文件、处理套接字、派生 worker 进程、打开日志文件和编译嵌入式的 Perl 脚本，master 进程是一个可以通过处理信号响应来管理请求的进程。

Nginx 的 worker 进程运行在一个忙碌的时间循环处理中，用与处理进入的连接。每一个 Nginx 模块被构筑在 worker 中，因此任何请求处理、过滤、处理代理的连接和更多的操作都worker 进程中古玩城。由于这种 worker 模型，操作系统能够处理每一个进程，并且调度处理程序最佳的运行在每一个处理器内核上，如果有任何阻塞 worker 进程的进程，例如，磁盘 I/O，那么需要配置的 worker 进程要多于 CPU 内核数，以便于处理负载。

还有少数服务程序的 Nginx 的 master 进程用与处理专门任务，在这些进程有 cache loader 和 cache manager 进程，cache loader 进程负责 worker 进程使用缓存的元数据准备，cache manager 进程负责检查缓存条目及有效期。

nginx 建立在一个模块化的方式之上，master 继承提供了每个模块可以执行其功能的基础，每一个协议和处理程序作为自己的模块执行，各个模块链接在一个成为一个管道来处理连接和请求。在处理完成一个请求之后，交给一系列过滤器，在这些过滤器中响应会被处理，这些过滤器有的处理子请求，有的是 nginx 的强大功能之一。

子请求是 nginx 根据客户端发送的不同 URI 返回的不同结果，这依赖与配置，它们可能会多重嵌套和调用其他的子请求。过滤器能够从多个子请求收集响应，并且将它们组合成一个响应发送给客户端，然后，最终确定响应并将其发送到客户端，这种方式下，可以让多个模块发挥作用。

## master-worker 模式优势

 - master 模式专注于自己的管理工作，处理管理员的请求，包括启动服务、停止服务、重载配置文件、平滑升级程序等
 - worker 进程专注于处理请求，这样更高效，同时，一个 worker 进程出现问题并不会影响到 worker 进程的工作